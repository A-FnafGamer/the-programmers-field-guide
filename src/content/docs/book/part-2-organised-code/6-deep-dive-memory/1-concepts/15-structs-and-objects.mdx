---
title: Structs and Objects
---

Consider the difference between value and reference types, and where they get allocated in memory when your program runs.


C# provides two different *class like* coding structures: **classes** and **structs**. These two tools allow you to do basically the same things, but one is a **reference type** and the other a **value type**. Let's explore how these two different kinds of type work and the relationship between memory usage and value and reference types.

Methods only have direct access to the data that stored on the stack,. This data comes from within the local variables and parameters that are coded within the method. In order to access values on the heap, methods need data that can tell it where abouts on the heap the value can be located.

In lower level languages, this is achieved using **pointers**. The value of a pointer is the address of the value it *points* to. While it is possible for pointers to refer to any location (stack, heap, or code) they must be used if you want to access values outside of the stack. To access a value outside of the stack, you store a pointer value in a local variable, or parameter, and use this to keep track of where the data is on the heap.

One of the challenges with pointers, was the level of access you had to the actual memory location. Internally, pointers are just integer values, the number stored in the pointer was the associated location in memory. If you changed this value, then the pointer now referred to another location in memory. This level of access made it easy to make small mistakes.

To avoid these kinds of issues, languages like C# do not make use of pointers (though they are available in unsafe C# code). Instead, they use **references**. A reference is a pointer where you do not have the ability to manually change the location in memory that it refers to. Rather than having special syntax to declare reference variables, as is done in C/C++, C# instead introduces the idea value and reference types.

When you declare a variable, what you are getting depends on the variable's type.

- A value type stores the data
- A reference type stores a reference (pointer) to something that is elsewhere. 

In C# a **struct** is a value type where as a **class** is a reference type.

This also has the impacts what happens when you work with these variables. The following code illustrates how value types work. The `ts` and `tsCopy` variables are both `TestStruct` values, so each has its own `Data` value (as integers are also value types). So at the end of this code, the `ts.Data` has the value 10, where as `tsCopy.Data` has the value 20.

```cs
struct TestStruct
{
    public int Data;
}

TestStruct ts = new TestStruct();
TestStruct tsCopy = ts;
ts.Data = 10;
tsCopy.Data = 20;

// ts.Data is 10, tsCopy.Data is 20
```

![A visualisation showing separate ts and tsCopy variables, each with their own value.](./images/sit771-StructClass.png)

The following code illustrates how this differs with reference types. In this case `tc` and `tcCopy` are both storing a reference to a `TestClass` object. This object is created by the `new` command, and the address of this object is stored in `tc`. When we copy `tc` into `tcCopy` we are copying this address, which in effect means that `tc` and `tcCopy` are both referring to the same object on the heap. So at the end of this code, the `Data` field of the object has the value 20, which can be accessed by either `ts.Data` or `tsCopy.Data`.

```cs
class TestClass
{
    public int Data;
}

TestClass tc = new TestClass();
TestClass tcCopy = tc;
tc.Data = 10;
tcCopy.Data = 20;

// tc.Data is 20, tcCopy.Data is 20
```

![A visualisation showing the tc and tcCopy variables referring to the same object on the heap.](./images/sit771-ObjectClass.png)

The same pattern applies no matter where you are storing the value. So it is possible to have structs that are fields of an object, and references that are members of a struct. The key is to see value types as a value, and reference types as a reference.

Further reading:
- [Value and Reference Types](https://en.wikibooks.org/wiki/C_Sharp_Programming/Variables#Value_types) in the online C# book.
- [Types](https://msdn.microsoft.com/en-us/library/ms173104.aspx) in the C# Programming Guide.


### Your Task

Think about the difference between value and reference types. We typically use classes and objects, but can you think of any uses for structs? Under what circumstances would you use a struct over a class?

Let us know in the comments.


